# 4주차. 암호의 역사

# 시저 암호

- 줄리어스 시저(유리우스 케사르)가 사용하였다는 암호
- 평문으로 사용되는 알파벳을 일정한 문자 수 만큼 평행이동 시킴으로써 암호화

## 암호화와 복호화

- 암호화: 특정 문자 수 만큼 평행이동, 키 = 3
- 복호화: 암호화 때와 동일한 크기의 역방향 평행이동, 키 = -3

## 전사 공격에 의한 해독

- 전사공격: 키가 될 수 있는 모든 가능한 후보들은 시도해보는 방법
- 알파벳이 26문자이기에 키는 0부터 25까지 26가지

# 단일 치환 암호

- 평문을 구성하는 알파벳을 다른 알파벳으로 변환하는 암호
- 시저 암호는 단일 치환 암호

## 암호화와 복호화

- 예제
  - 평문: kabsoonyee
  - 암호문: SWYLBBNKXX
- 키: 치환표
- 암호화
  - 약점: 평문에 등장하는 문자의 빈도가 암호문으로 바뀐 뒤에도 암호문 내에서 동일한 빈도로 나타난다.
- 복호화
  - 암호화 때 사용한 치환표 필요
  - 송신자와 수신자의 치환표 공유

## 암호의 키 공간

- 전사 공격으로 해독은 어려움, 시저 암호에 비해 훨씬 많은 키 후보를 가질 수 있기 때문
- 키 공간
  - 해당 암호에서 사용할 수 있는 모든 키의 집합
  - 이 키 공간에 속하는 가능한 키의 총수를 키 공간의 크기
  - 키 공간 크면 전사공격 어렵다
  - 단일 치환 암호 키의 총수: 26 x 25 x 24 x 23 ... x 1 = `4 * 10의 26승, 4조의 1000조 배 쯤`

## 빈도 분석에 의한 해독

- 전사공격은 어렵지만 빈도분석 암호 해석법을 사용하면 단일 치환 암호도 해석 가능
- 자주 쓰는 알파벳의 출현 빈도를 파악하고 치환해보며 추측(영어 단어의 조합을 예상하며, ex. `the`, `is`, 등)
- 해독 작업
  - 빈도가 높은 문자 뿐 아니라 빈도 낮은 문자도 단서
  - 처음과 끝 아는 것도 단서
  - 단어 단락을 알면 그것도 단서
  - 암호문이 길면 해독 용이
  - 같은 문자가 연속해서 나타나면 그것은 단서
  - 해독 속도는 점점 빨라짐

# 다중 치환 암호

- 평문에 등장하는 문자의 빈도와 암호문에 등장하는 문자의 빈도를 다르게 만드는 암호 알고리즘
  - 비장느르 암호
  - 에니그마 기계
- 빈도분석을 이용한 공격은 무용지물

# 에니그마

- 독일의 세르비우스가 20세기 초에 발명한 암/복호화 수행하는 기계
- 에니그마는 독일어로 수수께끼를 의미
- 회전하는 원반과 전기회로를 써서 강력한 암호를 만들고자 시도
- 발명 당시 에니그마를 상용으로 사용
- 나치독일 시대에는 군용으로 사용하려고 개량

## 암호통신

- 타이프라이터와 톱니바퀴와 전지와 전구를 조합한 기계
- 암/복호화를 1대의 기계로 수행
- 송수신자는 각각 1대씩 에니그마 소유
- 흐름
  - 송신자는 코드북의 날짜별 지침에 따라 에니그마 설정하여 암호화
  - 무선통신으로 암호문 전달
  - 수신자는 암호문을 코드북의 날짜별 지침에 따라 에니그마 설정하여 복호화

## 구조

에니그마는 알파벳 26문자를 암/복호화 할 수 있다

- 전원
- 램프(출력)
- 키(입력)
- 플러그 보드: 세팅 뒤 하루 동안 변경 없이 사용
- 로터1: 키를 한 번 칠때 마다 1/4 회전
- 로터2: 로터1의 키를 한 번 칠 때 마다 1/4 회전
- 로터3: 로터2의 키를 한 번 칠 때 마다 1/4 회전
- 반사기: 변경 안 함

> 알파벳 4문자일 경우

#### 로터

- 로터는 앞 뒤 단자가 전선으로 연결된 원반 모양의 부품
- 로터 하나하나의 연결선은 바꿀 수 없지만, 문자를 입력할 때마다 자동 회전
- 하나 문자 입력하면 로터1이 1/4회전, 로터1이 1회전 하면 로터2가 1/4회전, 로터2가 1회전하면 로터3이 1/4회전 (1/4회전은 알파벳이 4개일 때)

## 예제. secretletter 암호화

- 코드북의 날짜별 지침에 따라 에니그마 설정
- 통신 키 암호화
- 램프보고 기록하기
- 통신키에 대한 암호문은 KLIUSE
- 송신자가 선택한 통신 키 uat를 이용하여 에니그마 재설정
- 평문을 에니그마를 통해 암호화
- 램프보고 기록하기
- 평문에 대한 암호문은 RAUIMSOPULBS
- 두 암호문 붙이기 (통신키, 메시지)
- 최종 암호문 KLIUSERAUIMSOPULBS

## 암호화

- 에니그마 설정
- 통신키 암호화
- 암호화된 통신키 메모
- 에니그마 재설정
- 메시지 암호화
- 결합

## 날짜별 키와 통신 키

- 날짜별 키는 메시지의 암호화가 아니라 통신키의 암호화에 사용
- 날짜별 키는 키를 암호화 하기 위한 키
  - 키 암호 키라고도 한다
- 메시지를 통신키로 암호화하고, 통신키를 날짜별 키로 암호화하는 2단 구조

## 통신 오류의 회피

- 통신키 uat 2회 연속해서 uatuat라고 입력
- 당시 무선 기술수준이 낮아 통신이 제대로 되지 않는 경우가 많았기 때문

## 복호화

- 통신키 암호문과 메시지 암호문 분리 (KLIUSE / RAUIMSOPULBS)
- 코드북의 날짜별 지침에 따라 에니그마 설정
- 통신키의 복호화
- 램프보고 기록하기
- 송신자가 선택한 통신 키 uat
- 에니그마 재설정
- 암호문의 복호화
- 램프보고 기록
- 메시지 secretletter

## 약점

- 통신키를 2회 반복한 것을 암호화한다
- 통신키를 선택한 것이 사람이다
- 코드북을 배송하지 않으면 안된다

## 해독

- 에니그마 설계는 숨기는 것에 의한 보안에 의존하지 않았다
- 폴란드의 암호 해독자 르예프스키
  - 날짜별 키에 의한 암호문으로부터 날짜별 키를 간파하는 방법 고안
- 영국 암호 해독팀은 블레츨리 파크에 모여 에니그마 해독

# 암호 알고리즘과 키

## 분리 이유

- 암호 알고리즘 안에는 변경 가능한 부분이 반드시 포함되기 때문
- 변경 가능한 부분이 키에 해당

## 암호알고리즘과 키

| 암호명                    | 암호 알고리즘                                                                                                     | 키                                                         |
| ------------------------- | ----------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------- |
| 시저                      | 평문 각 문자를 지정한 문자 수 만큼 평행 이동                                                                      | 평행 이동하는 문자 수                                      |
| 단일치환암호              | 치환표에 따라 알파벳 변환                                                                                         | 치환표                                                     |
| 에니그마(통신키의 암호화) | 에니그마 기계를 써서 플러그 보드의 연결선, 3장의 로터의 순서, 각 로터의 설치 각도에 따라 알파벳 변환              | 플러그 보드의 연결선, 3장의 로터 순서, 각 로터의 설치 각도 |
| 에니그마(통신문의 암호화  | 플러그 보드의 연결선과 3장의 로터의 순서를 고정한 에니그마 기계를 사용하여 각 로터의 설치 각도에 따라 알파벳 변환 | 각 로터의 설치 각도                                        |

- 키는 매회 변경
- 암호 알고리즘은 반복 사용

# 퀴즈

## 시저 암호

PELCGBTENCUL 해독해봐라

> 전사공격으로 해독, 키는 13, 평문은 cryptography (교재 89페이지), 즉 암호가 된다

## 단일치환 암호의 개선

동일 문자로 암호화되지 않는 것이 더 어려워지는 게 맞는가?

> 아니다. 오히려 같은 문자의 경우의 수를 제외하게 되어서 더 경우의 수가 줄어든다
