# 12주차. 보안관제와 침해 대응

# 보안 관제

- 조직의 중요 정보 자원을 보안 공격으로부터 보호하기 위한 일련의 활동
- 좁은 뜻: Security Monitoring
- 넓은 뜻: + Control

## 과정

- 예방
- 탐지
- 대응
- 공유 및 개선

## 구성요소

#### 보안관제 조직

- 모니터링 팀
  - 365일 24시간 보안 관제 시스템의 이벤트 모니터링
- 침해 사고 대응 팀(CERT)
  - 이상 트래픽이나 이벤트에 대해서 상세하게 분석하여 판단하고 대응 조치 수행
- 정보 공유 분석 센터(ISAC)
  - 각 산업 분야 별로 보안 침해 사고에 대해 효과적으로 공동 대응하기 위한 조식
  - 국내: 금감원 주도 금융 ISAC, 통신사업자 중심의 ISAC 등 설립되어 운영

#### 보안관제 시스템

- 정보 시스템: 보안 관제 대상 - 윈도우, 리눅스 서버 등
- 정보 보호 시스템: 침입 탐지 및 대응을 위한 정보 제공 - IDS/IPS, 방화벽 등
- 통합 보안 관제 시스템
  - 침입 탐지 정보의 수집 및 처리
  - 종류
    - SIEM
      - SEM: 실시간 모니터링, 이벤트의 상관관계 및 알림 등 기능 제공
      - SIM: 장기간에 대한 분석 및 보고 자료 제공
      - 장점 (ESM 대비)
        - 다양한 정보 시스템으로부터 로그 수집 및 분석 가능
        - 빅데이터 수준의 장시간의 연관 분석 가능
        - 지능형 보안에 더 적합
    - ESM
      - 각 정보 보호 시스템에서 생성된 로그를 수집하고 이를 정규화하여 저장함을 통해 로그를 일관되게 나타내어 실시간 모니터링에 활용

## 보안관제의 수행 원칙

- 무중단의 원칙: 24시간 365일
- 전문성의 원칙: 정보시스템, 정보보호시스템, 통합보안관제시스템 등에 대한 지식 뿐 아니라 네트워크 등의 이론에서도 전문성이 있어야
- 정보공유의 원칙: 어느 한 보안 관제 조직에서의 탐지 및 차단 정보가 다른 보안 관제 조직에서도 공유되어야 함

## 보안 관제 유형

- 직접 관제: 내부 직접 보안 관제 시스템 구축하며 구축에 투입되는 인력이 내부 인력일 때
- 파견 관제: 조직 내부에 보안 관제 시스템을 두고 직접 운영하지만 구성원은 관련 업체로부터 파견 받음
- 원격 관제: 전문 관제 업체가 보유한 조직 외부의 보안 관제 시스템 사용
- 클라우드 관제: 조직의 IT 환경이 클라우드에 있는 경우에 대한 관제

## 탐지 규칙

- 탐지 규칙을 이용해 IDS/IPS 등에서 보안 공격을 사전에 탐지 가능
- 특정 악성코드 또는 보안 공격이 네트워크로 유입되는 것을 탐지하기 위해 개발한 시그니처
  - 보안에서 시그니처: 특정 악성코드 혹은 취약점 등을 식별할 수 있는 문자열
- 탐지 규칙: 헤더와 옵션

#### 탐지규칙 헤더와 옵션

- 대응 동작
- 프로토콜 종류
- 출발지 및 도착지의 IP 주소
- 출발지 및 도착지의 포트
- 방향

#### 탐지조건의 구성

- Payload
- Non-payload
- Rule threshold
- General

#### 예시

- 내부에서 외부로 나가는 HTTP 트래픽 탐지
  `alert tcp IP(이하 CIDR 표현) -> !IP (msg:"in-out http")`
- 내부 telnet 서버로 외부에서 접근하려는 트래픽 탐지 및 차단
  `drop tcp !IP any -> IP (msg: "illegal telnet attempt")`
- 내부로 엑셀 파일을 POST 방식으로 업로드하는 트래픽 탐지
  `alert tcp any any -> IP any (content: "POST" ; pcre: "/(₩x2exls|₩x2exslx)/" ; msg: "excel file POST upload")`
- 내부 웹 서버로 Slowloris 공격 트래픽 탐지 및 차단
  `drop tcp any any -> IP 80 (flow:established ; pcre: "/[^₩x0d₩x0a]₩x0d₩x0a$/" ; msg: "msg slowloris attack attempt")`

#### 정탐과 오탐

- 오탐: 정상적인 네트워크 트래픽을 보안 공격이라고 판단 혹은 보안 공격 트래픽임에도 정상적인 트래픽으로 판단
- 오탐 종류
  - 부정 오류: 공격 시도를 정상적인 접근이라고 인식하여 그냥 통과시키는 것 - 보안 사고
  - 긍정 오류: 정상적인 접근을 공격 시도로 오해하는 것 - 가용성 침해

# 침해 대응

## 침해 대응 절차

- 사전 준비
  - 효율적인 사고 대응 위해 준비 단계
  - 조직적인 침해 대응 체계 구축: 침해 대응팀 조직 - 보안 전문가 및 각 분야의 전문가들로 구성
    - 사고 조사를 위한 도구 구비
    - 사고 조사를 위한 문서 양식 정형화
    - 대응 전략 수행을 위한 적절한 정책과 운용 과정 수립
    - 임직원들에 대한 교육 훈련 실시
  - 침해대응팀: CERT 혹은 CSIRT
    - 보안 관련 침해 사고 대응 위해 조직
    - 사고의 접수 및 처리 지원을 비롯해 예방, 피해 복구 등의 임무를 수행하는 조직
    - 세계 최초 CERT
      - 카네기멜론 대학 설립
      - 웜을 효과적으로 대응 하기 위해 조직
    - 최근에는 CSIRT라는 용어 사용 - 카네기멜론 대학이 CERT에 대한 상표권 등록을 해서
    - 국가대표 CERT
      - 국가의 사이버보안 조정 역할을 수행하는 국가 CERT
      - CERT 뒤에는 조정 센터라는 명칭이 붙는 경우가 많다
- 사고 탐지
  - 정보보호시스템에 의해: IDS(침입탐지), IPS(침입방지)
  - 통합보안관제 시스템에 의해: ESM, SIEM
  - 초기 보고 필요 요소
    - 현재 시간 날짜
    - 사건 일시
    - 관련 SW/HW 목록
    - 사고 탐지 및 사고 발생 관련자의 네트워크 연결 지점
    - 사고 보고 내용과 출처
  - 일반 보안 사고와 중대 보안 사고
    - 일반: 악성코드 침해, 네트워크 및 시스템에 대한 비인가된 침해 및 시도
    - 중대: 중요도 등급 1등급인 정보 자산 누출, 정보 자산 오용으로 기업 이미지 침해
- 초기 대응
  - 침해 대응팀이 초기 보고 사항들을 인수/인계 받음
  - 침해 발생 시스템이나 네트워크를 식별하여 해당 시스템의 네트워크를 차단
  - 업무 및 서비스에 미치는 영향을 미치는지 검증 및 확인
- 대응 전략 수립
  - 수집 자료 기반 현재 상황에서 가장 적절한 대응 전략 수립
    - 사고 피해 범위 따라
    - 내부, 외부 의뢰
- 사고 조사
  - 정밀 조사 단계, 디지털 포렌식
  - 자료 수집과 자료 분석 단계
- 보고서 작성
  - 조사된 결과를 조직의 상급자 및 외부에 보고하기 위한 보고서 작성
- 복구 및 해결
  - 시스템에 설치된 백도어 등 악성코드를 제거하고 네트워크 연결
  - 관리자 및 시스템 계정의 패스워드 재설정 필요
  - 운영체제 및 백신 등의 보안 패치 적용 필요

# 포렌식

- 디지털 포렌식: 디지털 기기에 저장된 전자적 증거물을 사법기관에 제출하기 위해 데이터를 수집 및 분석하여 보고서를 작성하는 일련의 작업

## 디지털 포렌식 5대 원칙

- 정당성의 원칙
  - 증거 자료가 적법한 절차를 거쳐서 정당하게 획득되어야 한다는 원칙
- 무결성의 원칙
  - 수집 증거가 결함 없이 위.변조 되지 않았음을 증명할 수 있어야 한다는 원칙
- 연계보관성의 원칙
  - 증거가 획득된 다음 증거가 이송, 분석, 보관, 법정 제출이라는 일련의 과정 및 각 과정마다 담당자가 명확해야 하며 이에 대한 추적이 가능해야 한다는 원칙
- 재현의 원칙
  - 동일한 조건과 동일한 상황이라면 디지털 포렌식의 분석 결과는 항상 같은 결과가 나와야한다는 원칙
- 신속성의 원칙
  - 디지털 포렌식의 수행 전 과정은 지체 없이 신속하게 진행되어야 한다는 원칙

## 유형

- 분석 목적에 따른 유형
  - 수사 관점: 범행 입증 필요한 증거 찾는 것
  - 사고 대응 관점: 침해 사고에 대응하는 것이 주된 목적
- 분석 대상에 따른 유형
  - 디스크 포렌식: 비휘발성 저장매체에서 분석, 가장 발전된 분야
  - 라이브 포렌식: 메모리와 같은 휘발성 데이터 대상
  - 네트워크 포렌식: 전송되는 데이터 분석 및 형태 조사하는 분야
  - 인터넷 포렌식: 웹, 이메일, FTP 등 인터넷 프로토콜이 사용된 증거를 수집하는 분야
  - 모바일 포렌식
    - 휴대폰, 스마트폰, 디카, PDA, 내비게이션 등 다양한 모바일 기기
    - 통화, 문자, 카메라 등 기본 정보 + GPS, 메신저, SNS, 메모 등
  - DB 포렌식
  - 기타
    - 암호, 사물인터넷, 멀티미디어, 소스코드

## 과정

- 증거물 획득하고 분석하여 보관하는 것이 핵심
- 증거물 보고서: 연계보관성 원칙에 따라 꼬리표가 있어야
- 과정
  - 사전준비: 수사 필요한 도구 확보, 미리 도구 테스트 및 여러 방법론 숙지
  - 증거수집: 무결성 보장하면서 원하는 데이터 수집 단계 (가장 중요한 단계)
  - 보관 및 이송: 연계 보관성 원칙을 만족하며 이송
  - 분석 및 조사: 수집한 데이터로부터 가치 있는 정보 획득
  - 보고서 작성: 분석 및 조사 단계를 거쳐 취합된 증거들을 보고서로 만드는 것
    - 독자: 법관과 검사, 변호사와 배심원 등
    - 누구든지 읽어도 이해할 수 있도록 쉽게 작성필요하고 논리적이며 감성적인 부분까지 고려되어야

## 디지털 포렌식 도구 종류

- 엔케이스
  - 가이던스 소프트웨어에서 개발한 프로그램
  - 업계 표준으로 자리 잡은 디스크 포렌식 조사 및 분석 도구
  - 미국 NIST의 CFTT 검증 획득
- FTK
  - AccessData 사에서 개발한 디지털 포렌식 도구
  - 엔케이스 다음 많이 사용
  - 데이터 획득, 분석 및 보고서 작성 기능 등 제공
  - 파일 시그니처 분석 기능 등 여러 도구 제공
- X-Ways Forensics, Volatility, Intella(이메일), iLook
