# 10주차. 웹 보안

# 웹 취약점의 이해

- OWASP에서 각 분야별 상위 열 가지 주요 취약점 발표

# 주요 취약점

## 명령 삽입 취약점 (Injection)

- 전송받는 인수에 포함된, 특정 명령을 실행하는 코드를 적절히 필터링하지 못하면 삽입 공격에 대한 취약점 발생
- 명령 삽입공격은 SQL, OS, LDAP 등 웹으로 명령을 전달하는 모든 경우에 적용 가능.
- 웹 서버에서 데이터베이스로 전송되는 SQL 쿼리에는 ID, PW, 검색어 등 여러 가지 인수가 사용됨. SQL 삽입공격은 이 인수에 추가 실행코드를 넣는 것

## 인증 세션 관리 취약점

- 취약한 패스워드
- 관리자가 패스워드를 변경하는 인터페이스가 별도로 만들어지지 않아 개발자가 처음 설정한 패스워드를 그대로 사용 하는 경우가 많음
- admin/admin 과 같은 패스워드 자주 발견 가능

#### 사용자 데이터를 이용한 인증

- 이러한 문제점은 최초 인증 후 인증과 신분 증명 역할을 클라이언트에 넘겼기 때문에 발생
- 서버가 통제할 사항은 클라이언트로 넘기지 않아야 할 것.

## XSS 취약점

- 공격자가 작성한 스크립트가 다른 사용자에게 전달되는 것
- 다른 사용자의 웹 브라우저 안에서 적절한 검증 없이 실행되므로 사용자 세션 탈취, 웹 사이트 변조, 악의적인 사이트로 사용자 이동 가능

## 취약한 접근 제어

- 인증된 사용자가 수행할 수 있는 것에 대한 제한을 제대로 적용해야함.
- 사용자 계정 접근, 중요 파일 보기, 사용자 데이터 수정, 접근 권한 변경 등과 같이 권한 없는 기능을 사용하거나 데이터 접근 가능
- 관리자 페이지가 추측하기 쉬운 URL이거나 인증이 필요한 페이지에 인증을 하지 않고 우회하여 접속할 수 있는 취약점
- 인증 우회를 막으려면 웹의 중요 페이지에 세션 값을 확인하는 검증 로직 입력해야
- 프로그램 개발 시 표준 인증 로직 만들어 웹에 존재하는 모든 페이지의 앞 부분에 입력해야

#### 디렉터리 탐색

- 웹 브라우저에서 확인 가능한 경로의 상위를 탐색하여 특정 시스템 파일 다운로드 하는 것
- 자료실에 업로드한 파일을 전용 프로그램으로 내려받을 때 파일 이름을 필터링하지 않아서 생김.
- 파일 다운로드 전용 프로그램 작성하여 `..`와 `/` 문자 필터링해야

## 보안 설정 오류

- 디렉터리 리스팅: 웹 서버 특정 디렉터리를 열면 관련 파일과 목록 모두 나열되는 취약점. 관리자가 인지하지 못해 발생하는 것이 대다수
- 백업 및 임시 파일 존재: 백업이나 임시파일 삭제 안해서 공격자가 백업 파일을 통해 웹 애플리케이션의 내부 로직과 데이터베이스 접속 정보 등을 획득
- 미흡한 주석: 웹 프록시를 이용하면 사용자도 볼 수 있는 주석에 개발과정, 로직 설명, 디렉터리 구조, 테스트 소스 정보 등이 기록 되어 있으면 문제가 됨
- 파일 업로드 제한 부재: 공격자가 웹 서버에 악의적인 파일을 전송한 뒤 원격지에서 실행하면 웹 서버 장악, 내부 침투 공격 수행 가능.
- 리버스 텔넷
  - 웹 해킹으로 시스템 권한 획득 후 직접 명령을 입력하고 확인할 수 있는 셸을 획득하기 위한 방법으로 방화벽이 있는 시스템 공격할 때 주로 사용
  - 방화벽 내부에 존재하는 80포트를 이용한 웹 서비스만 제공하면 되기에 외부 인터넷 사용자에게 80번 포트만 허용.
  - 아웃바운드 정책에서 별다른 필터링을 안 하면 공격자의 텔넷 연결 허용이 되어서 문제가 생김.
  - 방어하려면 실행 파일 업로드를 막아야하고 내부에서 외부로 불필요한 접속도 방화벽으로 막아야 함.

## 민감한 데이터 노출

- 신카 정보, 주민번호, 인증 신뢰 정보 같은 민감한 데이터를 보호하지 않는 것이 주요 원인
- 민감한 데이터를 보호하려면 데이터 중요도에 따라 암호화 로직을 사용하고 데이터베이스 테이블 단위에서 암호화를 수행해야함.

## 공격 방어 취약점

- 예전 웹 애플리케이션은 해킹 공격을 탐지, 방지, 대응할 수 있는 기능이 없었다.
- APT 공격이 일반화 되어서 보안 솔루션으로 탐지가 어렵자 웹 애플리케이션 수준에서 자동으로 탐지, 로깅, 응답, 공격 시도 차단을 포함하도록 권고

## CSRF 취약점

- 불특정 다수를 대상으로, 로그인된 사용자가 공격자가 의도한 행위를 하게 만드는 것
- 악성 스크립트가 클라이언트에서 실행되는 XSS 공격과 달리 CSRF 공격은 사용자가 악성 스크립트를 서버에 요청한다는 차이

## 취약점이 있는 컴포넌트 사용

컴포넌트, 라이브러리, 프레임워크 및 다른 소프트웨어 모듈이 다양하게 사용되면서 보안에 취약한 컴포넌트가 사용되면 심각한 데이터 손실, 서버 장악이 가능

## 취약한 API

API를 통해 웹 서비스 상호 간의 연동이 이뤄지므로 API 사용 시 보안에 취약하지 않은지 충분한 검토 필요.

# 취약점 보완

- 특수문자 필터링: XSS 공격 , SQL 삽입 공격 대비
- 서버 통제 작용: CSS 기반의 언어로 필터링 하는 경우 공격자가 로직만 파악하면 필터링이 쉽게 무력화 되기에 ASP, JSP 등과 같은 SSS로 필터링된 로직을 수행해야
- 지속적인 세션 관리: 모든 웹 페이지에 일관성 있는 인증 로직을 적용하려면 기업 또는 웹 사이트 단위에서 세션 인증 로직을 표준화하고 표준을 준수하여 웹 페이지를 개발하도록 해야
