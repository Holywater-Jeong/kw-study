# 12주차. 5장 코드 보안, 6장 악성 코드

# 메모리 해킹

- 프로그램의 동작에 관여 안하고 프로그램이 실행되는 데 필요한 정보를 저장해둔 메모리를 조작하는 공격
- 게임머니나 아이템 조작과 같이 게임 해킹에 광범위하게 사용 됨
- 메모리 해킹은 사용자가 인지 못 하는 경우가 많고 휘발성이 강한 메모리의 특성상 흔적 추적 어려움
- 메모리 해킹 막으려면 메모리 주소에 저장되는 값을 암호화해야함

## 원리

#### 지뢰찾기 게임 통해 실습

- MHS 이용
- MHS open process - winmine 선택
- 메모리 해킹 할 주소 값 찾고 시간 값이 0으로 되어있으니 0이 있는 주소를 찾는다
- 총 주소 범위 0x000000000 ~ 0xFFFFFFFF에서 0x00400000 ~ 0x7FFF0000으로 제한
- 0x00400000은 exe 파일이 실행되는 기준 메모리, 0x7FFF0000 이상 값은 프로그램이 접근하지 못하는 영역
- 시간 값 가진 메모리 주소 찾기 위해 게임 시작하면 시간 값 증가
- 시간 값 증가를 이용하여 검색 대상 좁히기
- 메모리 값 변경

# 악성코드

## 역사

제작자가 의도적으로 사용자에게 피해를 주기 위해 만든 모든 악의적 목적을 가진 프로그램 및 매크로, 스크립트로 컴퓨터에서 작동하는 실행 가능한 모든 형태를 말함.

## 바이러스의 개념

컴퓨터 바이러스란 자기 자신을 복제하여 대상 프로그램에 포함해서 해당 프로그램을 감염시키는 프로그램

## 최초의 바이러스와 웜

- 최초 바이러스: 1986년 브레인 바이러스
- 최초 웜: 1988년 미국 네트워크 마비시킨 모리스 웜

## 매크로 바이러스 출현

- 1999년 멜리사
- 매크로: 엑셀이나 워드 등에서 특정한 기능을 자동화해놓은 일종의 프로그램

## 웜에 의한 대규모 피해

- 2001년 7월 13일 25만 대 이상의 컴퓨터가 8시간 만에 코드레드 웜에 감염
- 윈도우 2000, 윈도우 NT 서버를 경유지로 미국 백악관 공격, 국내도 최소 3만 대 이상의 시스템이 피해 입은 것으로 추정

## 인터넷 대란

- 2003년 1월 25일 인터넷 대란을 일으킨 SQL_Overflow, 일명 슬래머 웜이 등장
- 05시 29분 슬래머가 퍼진 후 06시를 기준으로 전 세계 74,855 대 시스템 감염
- 2003년 8월에는 1~2분 간격으로 컴퓨터를 강제 재부팅해 큰 피해를 준 블래스터 웜을 시작으로 웰치아 웜, 스팸 메일 집중 발송한 소빅.F 웜 등 발생

## 변종 웜 발생

- 2005년 3월에 MMS로 감염된 휴대전화에 저장된 전화번호로 악성코드를 퍼뜨리는 컴 워리어 등장
- 저장매체나 인터넷으로 전파되던 악성코드가 휴대전화 통신망으로 전파되기 시작

## 분류

#### 동작

- 바이러스: 자가복제와 감염, 다른 네트워크 컴퓨터로 스스로 전파되지 않음
- 웜: 인터넷 네트워크를 통해 전파, 스스로 전파 됨
- 트로이 목마: 악의적 공격자가 침투하여 사용자 컴퓨터 조종
- PUP: 잠재적으로 불필요한 프로그램으로 불편함을 주는 프로그램, 스파이웨어, 애드웨어 등이 해당

#### 목적

- 다운로더: 내려받은 데이터나 프로그램이 추가 공격하는 악성코드, 명령 집합체인 경우
- 드로퍼: 안에 존재하는 데이터로부터 새로운 파일을 생성하여 공격 수행
- 런처: 다운로더나 드로퍼 등으로 생성된 파일을 실행하기 위해 관련 기능 포함
- 애드웨어: 광고 포함 소프트웨어
- 스파이웨어: 개인이나 기업의 정보를 몰래 수집하여 동의 없이 다른 곳에 보내는 것이 목적
- 랜섬웨어: 파일을 암호화하고 자료를 인질 삼아 돈을 요구한다
- 백도어: 시스템 유지보수나 유사시 문제 해결을 위해 시스템 관리자가 보안 설정을 우회한 다음 시스템에 접근할 수 있도록 만든 도구인 백도어를 악의적인 목적을 가진 공격자가 시스템에 쉽게 재침입하는데 이용하는 경우
- 익스플로잇: 운영체제나 특정 프로그램의 취약점을 이용하여 공격
- 봇: DDoS 공격 시 지정된 공격을 수행하는 악성 코드
- 스캐어웨어: 실제 공격을 한 것이 아니라 공격을 했다고 겁주며 자사의 소프트웨어를 구매 유도하는 경우

## 감염 증상

- 시스템
  - 시스템 설정 정보 변경
  - FAT 파괴
  - CMOS 변경, 정보 파괴
  - 기본 메모리 감소
  - 시스템 속도 저하
  - 프로그램 자동 실행
  - 프로세스 종료
  - 시스템 재부팅
- 네트워크
  - 메일 발송
  - 정보 유출
  - 속도 저하
  - 메시지 전송
  - 특정 포트 오픈
- 하드디스크
  - 포맷
  - 부트 섹터 파괴
- 파일
  - 생성, 삭제, 감염, 손상, 암호화
- 특이점
  - 이상 화면 출력
  - 특정 음 발생
  - 메시지 상자 출력

# 바이러스

사용자 컴퓨터에서 프로그램이나 실행 가능한 부분을 몰래 수정하여 자신 또는 자신의 변형을 복사하는 것

## 부트 바이러스

- 플로피 디스크나 하드디스크 부트 섹터에 감염되는 바이러스, MBR과 함께 PC 메모리에 저장되어 부팅 시 자동으로 동작하여 부팅 후에 사용되는 모든 프로그램을 감염시킴
- 부트 바이러스를 이해하려면 컴퓨터의 부팅 순서를 알아야 함
  - POST
    - 운영체제를 설치할 때 하드웨어 자체가 시스템에 문제가 없는지 기본 사항을 스스로 확인하는 과정
    - BIOS에 의해 실행, 문제가 발생되면 경고음 등으로 알려줌
  - CMOS
    - 기본 장치 설정과 부팅 순서를 설정하며 이를 BIOS가 읽어 시스템에 적용
  - 운영체제 위치 정보 로드
    - 윈도우 2003 이전, 마스터 부트 레코드 정보를 읽는다
    - 윈도우 2008 이후, 윈도우 부트 매니저가 실행되는 단계
- 부트 바이러스는 운영체제 위치 정보를 로드하는 3단계에서 작동한다
- 부트 바이러스에 감염된 플로피디스크로 운영체제를 구동하면 바이러스가 MBR과 함께 PC 메모리에 저장되고 부팅 후 사용되는 모든 프로그램에 자신을 감염시킴
- 부트 바이러스의 종류에는 브레인, 몽키, 미켈란젤로 바이러스가 있다

## 파일 바이러스

- 파일을 직접 감염시켜 바이러스 코드를 실행시키는 것으로 하드디스크 부팅이 일반화되면서 부트 바이러스의 대안으로 등장
- COM, EXE와 같은 실행 파일과 오버레이 파일, 디바이스 드라이버 등에 감염되어 전체 바이러스의 80% 이상 차지
- 파일 바이러스는 프로그램을 덮어쓰는 경우, 프로그램 앞 부분에 실행 코드를 붙이는 경우
- 프로그램 뒷 부분에 바이러스 코드를 붙이는 경우가 있음
- 바이러스가 프로그램 뒷부분에 위치하는 것은 백신의 바이러스 스캔으로부터 자신의 존재를 숨기기 위함
- 예루살렘 바이러스, 선데이, 스코피온, 크로, FCL, CIH 바이러스가 파일 바이러스에 속한다

## 2세대 암호형 바이러스

- 바이러스 코드를 쉽게 파악 못하도록 함
- 바이러스 동작 시 메모리에 올라오는 과정에서 암호화가 풀리므로 백신은 이를 이용하여 메모리에 실행되어 올라온 바이러스와 감염 파일을 분석하고 치료
- 슬로, 캐스케이드, 원더러, 버글러 등이 있다

## 3세대 은폐형 바이러스

- 바이러스에 감염된 파일이 일정 기간 잠복기를 가지도록 만들음
- 이는 바이러스가 확산 되기도 전에 활동하기 시작하면 다른 시스템으로 전파되기 힘들다
- 은폐형 바이러스에는 브레인, 조시, 512, 4096 바이러스가 있다.
